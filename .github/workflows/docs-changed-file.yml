# https://github.com/marketplace/actions/changed-files
name: print changed files

on:
  push:
    branches:
      - main
    paths:
      - stories/docs/**/*.mdx

# -------------------------------
#  Optionally run on other events
# -------------------------------
#  schedule:
#     - cron: '0 0 * * *'
#
#  release:
#    types: [...]
#
#  workflow_dispatch:
#
#  push:
#    tags:
#      - '**'
#
#  merge_group:
#
# ...and many more

jobs:
  # -------------------------------------------------------------
  # Using GitHub's API is not supported for push events
  # -------------------------------------------------------------
  #
  # ----------------------------------------------------------------------------------------------
  # Using local .git history
  # ----------------------------------------------------------------------------------------------
  # Event `push`: Compare the preceding remote commit -> to the current commit of the main branch
  # ----------------------------------------------------------------------------------------------
  changed_files:
    runs-on: ubuntu-latest # windows-latest || macos-latest
    name: Test changed-files
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0 # OR "2" -> To retrieve the preceding commit.

      - name: Get changed files
        id: changed-files-specific
        uses: tj-actions/changed-files@v39
        with:
          files: |
            stories/docs/**/*.mdx

      - name: Run step if any of the listed files above change
        if: steps.changed-files-specific.outputs.any_changed == 'true'
        run: |
          echo "One or more files listed above has changed."

      - name: Run step if only the files listed above change
        if: steps.changed-files-specific.outputs.only_changed == 'true'
        run: |
          echo "Only files listed above have changed."

      - name: Run step if any of the listed files above is deleted
        if: steps.changed-files-specific.outputs.any_deleted == 'true'
        run: |
          for file in ${{ steps.changed-files-specific.outputs.deleted_files }}; do
            echo "$file was deleted"
          done

      - name: Run step if all listed files above have been deleted
        if: steps.changed-files-specific.outputs.only_deleted == 'true'
        run: |
          for file in ${{ steps.changed-files-specific.outputs.deleted_files }}; do
            echo "$file was deleted"
          done
